---
- name: Jenkins_Through_TF
  hosts: Ansible_Hosts
  become: yes
  tasks:
      - name: install wget
        yum:
          name: wget
          state: present
          
      - name: install openjdk
        yum:
           name: java-1.8.0-openjdk
           state: present
      
      - name: Download Jenkins RPM
        get_url:
            url: http://mirrors.jenkins-ci.org/redhat/jenkins-2.277-1.1.noarch.rpm
            dest: /tmp/jenkins-2.277-1.1.noarch.rpm
      
      - name: install jenkins
        yum:
           name: /tmp/jenkins-2.277-1.1.noarch.rpm
           state: present

      - name: start jenkins
        systemd:
            name: jenkins
            state: started
            
      - name: enable jenkins
        systemd:
            name: jenkins
            enabled: true

      - name: sleep for 30 seconds and continue with play
        wait_for: timeout=30
        delegate_to: localhost
      
      - name: init password jenkin
        shell: cat /var/lib/jenkins/secrets/initialAdminPassword
        changed_when: false
        register: result

      - name: print init password jenkins
        debug:
            var: result.stdout